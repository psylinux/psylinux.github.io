<!doctype html><html lang=en-us data-bs-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>Basic RISC-V Assembly Instructions - Marcos Azevedo (aka psylinux)</title><meta name=description content><meta name=author content="Marcos Azevedo Blog"><link rel=icon type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css><link rel=stylesheet href=/css/khata.css><link rel=stylesheet href=/css/code-highlight.css><script src=/js/khata.js></script><script src=/js/code-copy.js></script></head><body class="mx-auto text-white d-flex flex-column p-2"><nav aria-label="Primary navigation"><a class="me-2 fs-4" href=/><i class="bi bi-house-door-fill" aria-hidden=true></i>
<span class=visually-hidden>Home</span>
</a><a class="mx-2 fs-4" href=/menu><i class="bi bi-list" aria-hidden=true></i>
<span class=visually-hidden>Menu</span>
</a><a class="ms-2 fs-4" href=/search><i class="bi bi-search" aria-hidden=true></i>
<span class=visually-hidden>Search</span></a><div class="language-switcher d-inline-flex align-items-center gap-2 ms-3" aria-label=Language><span class=fw-semibold>English</span>
<a href=/pt/series/experimenting-with-risc-v/05-basic-assembly/>Português</a></div></nav><main class="flex-grow-1 d-flex flex-column"><article><h1 class=my-4>Basic RISC-V Assembly Instructions</h1><div class="metadata-panel p-2 mb-3 rounded border"><div class="metadata-value mb-1">Author: Marcos Azevedo</div><div class="metadata-value mb-1"><small>Date: <time>2026-01-20</time></small></div><div class="metadata-value mb-1"><small>Reading Time:
6 mins</small></div><div class="metadata-value mb-1"><small>Section:
<a href=/series title=Section>Series</a></small></div><div class="metadata-value mb-1"><small>Categories:
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/categories/series title="categories: series">series</a></small></div><div class="metadata-value mb-1"><small>Tags:
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/c-lang title="tags: c-lang">c-lang</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/programming title="tags: programming">programming</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/risc-v title="tags: risc-v">risc-v</a></small></div></div><div class="TableOfContents border rounded p-2 ms-2 mb-2"><nav id=TableOfContents><ul><li><a href=#1-goal>1. Goal</a></li><li><a href=#2-instruction-families>2. Instruction families</a></li><li><a href=#3-example-add-two-numbers-and-store-the-result>3. Example: add two numbers and store the result</a></li><li><a href=#4-minimal-linker-script-and-why-it-matters>4. Minimal linker script (and why it matters)</a><ul><li><a href=#41-create-a-tiny-linker-script>4.1. Create a tiny linker script:</a></li><li><a href=#42-the-linker-script>4.2. The Linker Script</a></li><li><a href=#43-build-and-run-in-qemu>4.3. Build and run in QEMU</a></li></ul></li><li><a href=#5-connect-with-gdb-multiarch>5. Connect with gdb-multiarch</a></li><li><a href=#6-exercises>6. Exercises</a></li><li><a href=#7-summary>7. Summary</a></li></ul></nav></div><h2 id=1-goal>1. Goal</h2><p>Learn the core RV32I instruction families and practice with a tiny hand-written program.</p><h2 id=2-instruction-families>2. Instruction families</h2><ul><li><strong>Arithmetic</strong>: <code>add</code>, <code>addi</code>, <code>sub</code></li><li><strong>Loads/stores</strong>: <code>lw</code>, <code>sw</code>, <code>lb</code>, <code>sb</code></li><li><strong>Branches</strong>: <code>beq</code>, <code>bne</code>, <code>blt</code>, <code>bge</code></li><li><strong>Jumps</strong>: <code>jal</code>, <code>jalr</code></li></ul><h2 id=3-example-add-two-numbers-and-store-the-result>3. Example: add two numbers and store the result</h2><p>File: <code>src/basic_add.s</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.section .text
</span></span><span style=display:flex><span>.globl _start
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>_start:
</span></span><span style=display:flex><span>  li t0, <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span>  li t1, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  add t2, t0, t1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  la t3, g_result
</span></span><span style=display:flex><span>  sw t2, 0<span style=color:#f92672>(</span>t3<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>1:
</span></span><span style=display:flex><span>  j 1b
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>.section .bss
</span></span><span style=display:flex><span>.align <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>g_result:
</span></span><span style=display:flex><span>  .word <span style=color:#ae81ff>0</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=4-minimal-linker-script-and-why-it-matters>4. Minimal linker script (and why it matters)</h2><p>When you run bare-metal assembly, there is no operating system or C runtime to decide where your code and data live in memory. The <strong>C Runtime (CRT)</strong> is the code that runs before your <code>main()</code> function and after it finishes.
It prepares the execution environment of a C program: stack, arguments, global variables, libraries, and only then calls <code>main()</code>.</p><p>Short CRT note (what it is and is not):</p><ul><li><strong>CRT is not libc</strong>. It is a tiny startup/shutdown layer, typically split into objects like <code>crt1.o</code>, <code>crti.o</code>, and <code>crtn.o</code>.</li><li><strong>The kernel never calls <code>main()</code></strong>. The entry point is <code>_start</code>; the CRT provides <code>_start</code> and then calls <code>main()</code> for you.</li><li><strong>No CRT means no automatic startup</strong>. If you omit CRT (like in bare-metal), you must implement <code>_start</code> yourself.</li></ul><p>Without CRT (C Runtime):</p><ul><li>There is no automatic <code>main()</code></li><li>You must provide <code>_start</code></li><li>You talk directly to the kernel via syscalls (System Calls)</li></ul><p>The linker needs explicit instructions about:</p><ul><li><strong>Entry point</strong>: where execution starts (<code>_start</code>).</li><li><strong>Memory address</strong>: where the image should be placed (QEMU&rsquo;s <code>virt</code> machine expects RAM at <code>0x80000000</code>).</li><li><strong>Section layout</strong>: where <code>.text</code>, <code>.rodata</code>, <code>.data</code>, and <code>.bss</code> go.</li></ul><h3 id=41-create-a-tiny-linker-script>4.1. Create a tiny linker script:</h3><p>File: <code>src/minimal_link.ld</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ENTRY<span style=color:#f92672>(</span>_start<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SECTIONS
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  . <span style=color:#f92672>=</span> 0x80000000;
</span></span><span style=display:flex><span>  .text : <span style=color:#f92672>{</span> *<span style=color:#f92672>(</span>.text .text.*<span style=color:#f92672>)</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  .rodata : <span style=color:#f92672>{</span> *<span style=color:#f92672>(</span>.rodata .rodata.*<span style=color:#f92672>)</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  .data : <span style=color:#f92672>{</span> *<span style=color:#f92672>(</span>.data .data.*<span style=color:#f92672>)</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  .bss : <span style=color:#f92672>{</span> *<span style=color:#f92672>(</span>.bss .bss.* COMMON<span style=color:#f92672>)</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=42-the-linker-script>4.2. The Linker Script</h3><p>This is the instructions for the Linker. Think of the Linker as a builder who takes piles of raw materials (your compiled code lines) and arranges them into a finished building (the executable binary).</p><ul><li><p><strong><code>ENTRY(_start)</code></strong></p><ul><li><strong>The Front Door</strong>: This tells the linker: &ldquo;When the computer loads this program, the very first instruction to execute is at the label <code>_start</code>.&rdquo;</li><li>Without this, the processor wouldn&rsquo;t know where to begin running your code.</li></ul></li><li><p><strong><code>SECTIONS { ... }</code></strong></p><ul><li><strong>The Blueprint</strong>: This block defines the memory map. It tells the linker exactly where to place different parts of your program in the computer&rsquo;s RAM.</li></ul></li><li><p><strong><code>. = 0x80000000;</code></strong></p><ul><li><strong>The Current Location Counter (<code>.</code>)</strong>: Think of the dot <code>.</code> as a &ldquo;cursor&rdquo; pointing to a specific memory address.</li><li><strong><code>0x80000000</code></strong>: These lines set the cursor to this specific address.</li><li><strong>Why this number?</strong> In many RISC-V systems (like the QEMU <code>virt</code> machine), physical RAM starts at address <code>0x80000000</code>. Lower addresses usually hold hardware registers or flash memory. This line says: &ldquo;Start putting our program right at the beginning of RAM.&rdquo;</li></ul></li><li><p><strong><code>.text : { *(.text .text.*) }</code></strong></p><ul><li><strong>The Code Section</strong>: <code>.text</code> is where your actual executable code (assembly instructions) lives.</li><li><strong><code>{ *(.text) }</code></strong>: This means &ldquo;Take the <code>.text</code> section from all input files (<code>*</code>) and put them right here.&rdquo;</li><li>Since the cursor was just set to <code>0x80000000</code>, your code goes first.</li></ul></li><li><p><strong><code>.rodata : { *(.rodata .rodata.*) }</code></strong></p><ul><li><strong>Read-Only Data</strong>: This is for constants, like string literals (&ldquo;Hello World&rdquo;) that shouldn&rsquo;t change.</li><li>They are placed immediately after the code.</li></ul></li><li><p><strong><code>.data : { *(.data .data.*) }</code></strong></p><ul><li><strong>Initialized Data</strong>: This is for global variables that have a starting value (e.g., <code>int score = 10;</code>).</li><li>They are placed after the read-only data.</li></ul></li><li><p><strong><code>.bss : { *(.bss .bss.* COMMON) }</code></strong></p><ul><li><strong>Uninitialized Data</strong>: <code>bss</code> stands for &ldquo;Block Started by Symbol&rdquo; (a historical term). Ideally, it holds global variables that don&rsquo;t have a value yet (e.g., <code>int buffer[100];</code>).</li><li>The linker doesn&rsquo;t store zeros in the file for this to save space; it just marks that space needs to be reserved in RAM.</li></ul></li></ul><div class="alert alert-warning my-4" role=alert><div class="fw-bold mb-2">Warning</div><p><strong>Why Order Matters</strong></p><p>When you are creating a linker script for bare-metal assembly, always place <code>.text</code> first! The CPU jumps blindly to the base address (<code>0x80000000</code>). If you put data (like <code>.rodata</code>) first, the CPU will try to &ldquo;execute&rdquo; your data bytes as instructions, causing an immediate crash. While smart loaders (like QEMU with <code>-kernel</code>) might handle this by reading the ELF entry point, raw binary payloads on real hardware will fail.</p></div><h3 id=43-build-and-run-in-qemu>4.3. Build and run in QEMU</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>riscv64-unknown-elf-gcc -O0 -g -ffreestanding -nostdlib -march<span style=color:#f92672>=</span>rv32im -mabi<span style=color:#f92672>=</span>ilp32 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -T src/minimal_link.ld src/basic_add.s -o build/basic_add.elf
</span></span></code></pre></td></tr></table></div></div><p>The terminal will hang because of the infinite loop at the end of the program. This is expected. To verify the result, open another terminal and use <code>gdb-multiarch</code> to inspect memory as explained in the next section.</p><h2 id=5-connect-with-gdb-multiarch>5. Connect with gdb-multiarch</h2><p>To debug, start QEMU with its GDB stub enabled and paused at reset:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>qemu-system-riscv32 -M virt -nographic -bios none -kernel build/basic_add.elf <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -S -gdb tcp::1234
</span></span></code></pre></td></tr></table></div></div><p>In another terminal, manually connect using <code>gdb-multiarch</code> and follow each step below:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gdb-multiarch build/basic_add.elf
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> set architecture riscv:rv32
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> target remote :1234
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> break _start
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> <span style=color:#66d9ef>continue</span>
</span></span></code></pre></td></tr></table></div></div><p>If you prefer a single command, you can run:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gdb-multiarch build/basic_add.elf -q <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -ex <span style=color:#e6db74>&#34;set arch riscv:rv32&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -ex <span style=color:#e6db74>&#34;target remote localhost:1234&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -ex <span style=color:#e6db74>&#34;break _start&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -ex <span style=color:#e6db74>&#34;continue&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Now you can inspect the result:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> info variables g_result
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> print &amp;g_result
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> next
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> x/wx &amp;g_result
</span></span></code></pre></td></tr></table></div></div><p>Output should show <code>0x0000002a</code>, which is <code>42</code> in decimal (<code>40 + 2</code>).</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Reading symbols from build/basic_add.elf...
</span></span><span style=display:flex><span>The target architecture is set to <span style=color:#e6db74>&#34;riscv:rv32&#34;</span>.
</span></span><span style=display:flex><span>Remote debugging using localhost:1234
</span></span><span style=display:flex><span>0x00001000 in ?? <span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>Breakpoint <span style=color:#ae81ff>1</span> at 0x80000000: file src/basic_add.s, line 5.
</span></span><span style=display:flex><span>Continuing.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Breakpoint 1, _start <span style=color:#f92672>()</span> at src/basic_add.s:5
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>         li t0, <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>         li t1, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>         add t2, t0, t1
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>         la t3, g_result
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span>0x80000010      <span style=color:#ae81ff>9</span>         la t3, g_result
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span><span style=color:#ae81ff>10</span>        sw t2, 0<span style=color:#f92672>(</span>t3<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> ni
</span></span><span style=display:flex><span><span style=color:#ae81ff>13</span>        j 1b
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> x/wd &amp;g_result
</span></span><span style=display:flex><span>0x80000020:     <span style=color:#ae81ff>42</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> q
</span></span></code></pre></td></tr></table></div></div><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Tip</div><ul><li>To quit GDB, type <code>quit</code> or <code>q</code>.</li><li>To stop QEMU, use <code>Ctrl+a x</code> in its terminal.</li></ul></div><h2 id=6-exercises>6. Exercises</h2><ol><li>Change the constants to compute <code>7 + 13</code> and verify in memory.</li><li>Replace the <code>add</code> with <code>sub</code> and observe the new result.</li><li>Add a loop that increments <code>g_result</code> five times.</li></ol><h2 id=7-summary>7. Summary</h2><ul><li>RV32I instructions are small and orthogonal.</li><li>A minimal program can run without libc by defining <code>_start</code>.</li><li>QEMU + GDB lets you inspect results in memory directly.</li></ul><div class=mt-4><script src=https://giscus.app/client.js data-repo=psylinux/psylinux.github.io data-repo-id=R_kgDORCdA4Q data-category=Comments data-category-id=DIC_kwDORCdA4c4C1fwh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></article></main><div class=footer><div class="mb-4 d-flex flex-row justify-content-around"><div class=mr-4><a href=/series/experimenting-with-risc-v/04-setup-toolchain/ data-toggle=tooltip data-placement=top title="Setting Up the Toolchain and QEMU"><i class="bi bi-chevron-left" style=font-size:2em></i></a></div><div class=ms-4><a href=/series/experimenting-with-risc-v/06-elf-and-binutils/ data-toggle=tooltip data-placement=top title="ELF Internals and Binutils: Seeing What the Compiler Produced"><i class="bi bi-chevron-right" style=font-size:2em></i></a></div></div><footer class="border-top border-light py-2 d-flex flex-row flex-wrap justify-content-between"><div class=copyright><small>psylinux</small></div><div><small>Copyrighted © Marcos Azevedo, 2025.</small></div></footer><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "b1b9cb012238436c9efbac840abc1907"}'></script></div></body></html>