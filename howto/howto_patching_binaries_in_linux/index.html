<!doctype html><html lang=en-us data-bs-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>HowTo :: Patching binary files in Linux - Marcos Azevedo (aka psylinux)</title><meta name=description content><meta name=author content="Marcos Azevedo Blog"><link rel=icon type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css><link rel=stylesheet href=/css/khata.css><link rel=stylesheet href=/css/code-highlight.css><script src=/js/khata.js></script><script src=/js/code-copy.js></script></head><body class="mx-auto text-white d-flex flex-column p-2"><nav aria-label="Primary navigation"><a class="me-2 fs-4" href=/><i class="bi bi-house-door-fill" aria-hidden=true></i>
<span class=visually-hidden>Home</span>
</a><a class="mx-2 fs-4" href=/menu><i class="bi bi-list" aria-hidden=true></i>
<span class=visually-hidden>Menu</span>
</a><a class="ms-2 fs-4" href=/search><i class="bi bi-search" aria-hidden=true></i>
<span class=visually-hidden>Search</span></a><div class="language-switcher d-inline-flex align-items-center gap-2 ms-3" aria-label=Language><span class=fw-semibold>English</span>
<a href=/pt/howto/howto_patching_binaries_in_linux/>Português</a></div></nav><main class="flex-grow-1 d-flex flex-column"><article><h1 class=my-4>HowTo :: Patching binary files in Linux</h1><div class="metadata-panel p-2 mb-3 rounded border"><div class="metadata-value mb-1"><small>Date: <time>2019-01-14</time></small></div><div class="metadata-value mb-1"><small>Reading Time:
7 mins</small></div><div class="metadata-value mb-1"><small>Section:
<a href=/howto title=Section>HowTo</a></small></div><div class="metadata-value mb-1"><small>Categories:
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/categories/howto title="categories: howto">howto</a></small></div><div class="metadata-value mb-1"><small>Tags:
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/assembly title="tags: assembly">assembly</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/nasm title="tags: nasm">nasm</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/dev title="tags: dev">dev</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/glibc title="tags: glibc">glibc</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/linux title="tags: linux">linux</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/userland title="tags: userland">userland</a>
<a class="px-1 mx-1 rounded border border-secondary bg-taxa" href=/tags/exploitation title="tags: exploitation">exploitation</a></small></div></div><div class="TableOfContents border rounded p-2 ms-2 mb-2"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#what-is-binary-patching>What is Binary Patching?</a></li><li><a href=#what-youll-need>What You&rsquo;ll Need</a></li><li><a href=#method-1-using-xxd-hex-editing>Method 1: Using xxd (Hex Editing)</a><ul><li><a href=#step-1-convert-binary-to-hex>Step 1: Convert Binary to Hex</a></li><li><a href=#step-2-edit-the-hex-file>Step 2: Edit the Hex File</a></li><li><a href=#step-3-convert-hex-back-to-binary>Step 3: Convert Hex Back to Binary</a></li><li><a href=#step-4-compare-binaries-using-hex-diffs>Step 4: Compare Binaries Using Hex Diffs</a></li></ul></li><li><a href=#method-2-using-bsdiff-binary-patches>Method 2: Using bsdiff (Binary Patches)</a><ul><li><a href=#step-1-install-bsdiff>Step 1: Install bsdiff</a></li><li><a href=#step-2-create-a-binary-patch>Step 2: Create a Binary Patch</a></li><li><a href=#step-3-apply-a-binary-patch>Step 3: Apply a Binary Patch</a></li><li><a href=#step-4-verify-the-result>Step 4: Verify the Result</a></li></ul></li><li><a href=#practical-example-patching-a-simple-binary>Practical Example: Patching a Simple Binary</a></li><li><a href=#troubleshooting>Troubleshooting</a></li><li><a href=#best-practices>Best Practices</a></li><li><a href=#next-steps>Next Steps</a></li><li><a href=#see-also>See Also</a></li></ul></nav></div><h2 id=introduction>Introduction</h2><p>Learn to patch binary files directly without source code using hex editing and binary diff tools; essential for fixing bugs, applying security patches, or modifying executables.</p><h2 id=what-is-binary-patching>What is Binary Patching?</h2><p>Binary patching is the process of modifying compiled executable files without access to their source code. This technique is useful for:</p><ul><li><strong>Fixing bugs</strong> in production binaries when recompilation isn&rsquo;t possible</li><li><strong>Applying security patches</strong> to legacy systems</li><li><strong>Reverse engineering</strong> and understanding how programs work</li><li><strong>CTF challenges</strong> and vulnerability research</li><li><strong>Modifying behavior</strong> of closed-source applications</li><li><strong>Creating binary diffs</strong> for distributing patches</li></ul><p>Instead of editing high-level source code and recompiling, you directly modify the machine code bytes in the executable file. This requires understanding hexadecimal representation and executable file formats.</p><div class="alert alert-warning my-4" role=alert><div class="fw-bold mb-2">Important Note</div>Binary patching should only be performed on files you own or have explicit permission to modify. Modifying copyrighted software without permission may violate licensing agreements or laws.</div><h2 id=what-youll-need>What You&rsquo;ll Need</h2><div class="alert alert-danger my-4" role=alert><div class="fw-bold mb-2">Prerequisites</div><p>Before patching binaries, ensure you have:</p><ul><li><strong>xxd</strong> - Hex dump tool (included in most Linux distributions with vim-common)</li><li><strong>diff</strong> - Text comparison tool (standard on all Linux systems)</li><li><strong>bsdiff</strong> - Binary diff/patch tool (install separately: <code>apt install bsdiff</code>)</li><li><strong>Backup copies</strong> of any files you plan to modify</li><li><strong>Basic hex knowledge</strong> - Understanding hexadecimal representation (0x00-0xFF)</li></ul></div><h2 id=method-1-using-xxd-hex-editing>Method 1: Using xxd (Hex Editing)</h2><p>The <code>xxd</code> command creates hexadecimal representations of binary files that you can edit with text editors, then convert back to binary.</p><h3 id=step-1-convert-binary-to-hex>Step 1: Convert Binary to Hex</h3><p>First, create hex dumps of the binary files you want to work with:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>xxd prog1.bin &gt; b1.hex
</span></span></code></pre></td></tr></table></div></div><p>This converts <code>prog1.bin</code> into a human-readable hexadecimal format saved in <code>b1.hex</code>.</p><p><strong>Example output format:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>00000000: 7f45 4c46 <span style=color:#ae81ff>0201</span> <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span>  .ELF............
</span></span><span style=display:flex><span>00000010: <span style=color:#ae81ff>0200</span> 3e00 <span style=color:#ae81ff>0100</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>7010</span> <span style=color:#ae81ff>4000</span> <span style=color:#ae81ff>0000</span> <span style=color:#ae81ff>0000</span>  ..&gt;.....p.@.....
</span></span></code></pre></td></tr></table></div></div><p>Each line shows:</p><ul><li><strong>Byte offset</strong> (left): Position in the file</li><li><strong>Hex values</strong> (middle): The actual bytes in hexadecimal</li><li><strong>ASCII representation</strong> (right): Printable characters (dots for non-printable)</li></ul><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Understanding xxd Output</div>The left column shows the file offset in hexadecimal. The middle section shows 16 bytes per line in hex format. The right section shows ASCII interpretation where <code>.</code> represents non-printable characters.</div><h3 id=step-2-edit-the-hex-file>Step 2: Edit the Hex File</h3><p>Now you can edit <code>b1.hex</code> with any text editor. Modify the hex values in the middle columns:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim b1.hex
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or use your preferred editor</span>
</span></span><span style=display:flex><span>nano b1.hex
</span></span></code></pre></td></tr></table></div></div><p><strong>Example modification:</strong>
Change instruction opcodes, string values, or jump addresses by editing the hex bytes.</p><div class="alert alert-warning my-4" role=alert><div class="fw-bold mb-2">Edit Carefully</div><p>Only modify the hex values in the middle columns. Don&rsquo;t change:</p><ul><li>The byte offsets (left column)</li><li>The line structure or spacing</li><li>The ASCII representation (right column) - it&rsquo;s auto-generated</li></ul><p>Even a small mistake can corrupt the binary and make it unexecutable.</p></div><h3 id=step-3-convert-hex-back-to-binary>Step 3: Convert Hex Back to Binary</h3><p>After editing, convert the hex file back to a binary:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>xxd -r b1.hex new_prog1.bin
</span></span></code></pre></td></tr></table></div></div><p>The <code>-r</code> flag tells xxd to reverse the conversion (hex to binary).</p><h3 id=step-4-compare-binaries-using-hex-diffs>Step 4: Compare Binaries Using Hex Diffs</h3><p>To see what changed between two versions, create hex dumps of both and compare:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>xxd prog1.bin &gt; original.hex
</span></span><span style=display:flex><span>xxd new_prog1.bin &gt; modified.hex
</span></span><span style=display:flex><span>diff original.hex modified.hex
</span></span></code></pre></td></tr></table></div></div><p><strong>Or use vimdiff for visual comparison:</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vimdiff original.hex modified.hex
</span></span></code></pre></td></tr></table></div></div><p>This shows exactly which bytes changed, making it easy to document or reverse your modifications.</p><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Binary Diff Alternative</div><p>For a more concise binary comparison, you can also use:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cmp -l prog1.bin new_prog1.bin
</span></span></code></pre></td></tr></table></div></div><p>This shows byte positions and values that differ between the two files.</p></div><h2 id=method-2-using-bsdiff-binary-patches>Method 2: Using bsdiff (Binary Patches)</h2><p>The <code>bsdiff</code> tool creates and applies binary patch files, useful for distributing modifications without sharing entire binaries.</p><h3 id=step-1-install-bsdiff>Step 1: Install bsdiff</h3><p>If not already installed:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install bsdiff      <span style=color:#75715e># Debian/Ubuntu</span>
</span></span><span style=display:flex><span>sudo yum install bsdiff      <span style=color:#75715e># Fedora/RHEL</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=step-2-create-a-binary-patch>Step 2: Create a Binary Patch</h3><p>Generate a patch file from an old and new version of a binary:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bsdiff old_prog.bin new_prog.bin patch.bin
</span></span></code></pre></td></tr></table></div></div><p>This creates <code>patch.bin</code>, which contains only the differences between the two files; much smaller than distributing the entire new binary.</p><p><strong>What this does:</strong></p><ul><li>Analyzes differences between <code>old_prog.bin</code> and <code>new_prog.bin</code></li><li>Creates compressed patch file containing only changed bytes</li><li>Patch file can be distributed separately from the full binary</li></ul><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Patch Size</div>Patch files are typically much smaller than full binaries. For example, a 1MB binary with a few byte changes might produce a patch file of only a few KB.</div><h3 id=step-3-apply-a-binary-patch>Step 3: Apply a Binary Patch</h3><p>To apply a patch file to the original binary:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bspatch old_prog.bin output.bin patch.bin
</span></span></code></pre></td></tr></table></div></div><p>This applies the modifications from <code>patch.bin</code> to <code>old_prog.bin</code>, creating <code>output.bin</code> which matches <code>new_prog.bin</code>.</p><p><strong>Use cases:</strong></p><ul><li>Distributing security fixes without sharing entire executables</li><li>Applying community patches to games or applications</li><li>Version control for binary files</li><li>Minimizing download sizes for updates</li></ul><h3 id=step-4-verify-the-result>Step 4: Verify the Result</h3><p>Always verify the patched binary matches expectations:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Compare file sizes</span>
</span></span><span style=display:flex><span>ls -lh old_prog.bin output.bin new_prog.bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check file integrity if you have checksums</span>
</span></span><span style=display:flex><span>sha256sum old_prog.bin output.bin new_prog.bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Test functionality</span>
</span></span><span style=display:flex><span>./output.bin --version
</span></span></code></pre></td></tr></table></div></div><h2 id=practical-example-patching-a-simple-binary>Practical Example: Patching a Simple Binary</h2><p>Here&rsquo;s a complete workflow for patching a binary to change a string:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 1. Create backup</span>
</span></span><span style=display:flex><span>cp myprogram.bin myprogram.bin.backup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Convert to hex</span>
</span></span><span style=display:flex><span>xxd myprogram.bin &gt; myprogram.hex
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. Search for the string you want to change</span>
</span></span><span style=display:flex><span>grep -n <span style=color:#e6db74>&#34;Hello&#34;</span> myprogram.hex
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. Edit the hex file (change the bytes)</span>
</span></span><span style=display:flex><span>vim myprogram.hex
</span></span><span style=display:flex><span><span style=color:#75715e># Find the line with &#34;Hello&#34; and change it to &#34;Hallo&#34; (or whatever fits)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. Convert back to binary</span>
</span></span><span style=display:flex><span>xxd -r myprogram.hex myprogram_patched.bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. Make executable</span>
</span></span><span style=display:flex><span>chmod +x myprogram_patched.bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 7. Test</span>
</span></span><span style=display:flex><span>./myprogram_patched.bin
</span></span></code></pre></td></tr></table></div></div><div class="alert alert-warning my-4" role=alert><div class="fw-bold mb-2">String Length Matters</div>When replacing strings in binaries, the replacement must be the same length or shorter than the original. Longer strings will overwrite adjacent data and likely crash the program. Pad shorter strings with null bytes (00) if needed.</div><h2 id=troubleshooting>Troubleshooting</h2><div class="alert alert-warning my-4" role=alert><div class="fw-bold mb-2">Common Issues</div><p><strong>Issue:</strong> Patched binary crashes or doesn&rsquo;t execute
<strong>Solution:</strong></p><ul><li>Verify hex file wasn&rsquo;t corrupted during editing</li><li>Check that you didn&rsquo;t modify file offsets or structure</li><li>Ensure executable permissions: <code>chmod +x patched.bin</code></li><li>Compare with original to identify unexpected changes</li></ul><p><strong>Issue:</strong> bspatch fails with &ldquo;corrupt patch&rdquo;
<strong>Solution:</strong></p><ul><li>Ensure the patch file wasn&rsquo;t corrupted during transfer</li><li>Verify you&rsquo;re using the correct original binary version</li><li>Check file permissions on all involved files</li></ul><p><strong>Issue:</strong> String replacement causes crashes
<strong>Solution:</strong></p><ul><li>Replacement strings must be same length or shorter</li><li>Pad with null bytes (00) if shorter</li><li>Check for null terminators (00) at end of strings</li></ul><p><strong>Issue:</strong> Changes don&rsquo;t seem to take effect
<strong>Solution:</strong></p><ul><li>Clear any cached versions: <code>rm -f cached_version</code></li><li>Verify you&rsquo;re running the patched binary, not original</li><li>Check if binary has anti-tampering or signature verification</li></ul></div><h2 id=best-practices>Best Practices</h2><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Binary Patching Tips</div><ul><li><strong>Always backup</strong> original files before patching</li><li><strong>Document changes</strong> you make for future reference</li><li><strong>Test thoroughly</strong> after applying patches</li><li><strong>Use version control</strong> for patch files themselves</li><li><strong>Verify checksums</strong> after applying patches</li><li><strong>Keep patch files small</strong> by only modifying necessary bytes</li><li><strong>Consider legal implications</strong> before modifying binaries</li></ul></div><h2 id=next-steps>Next Steps</h2><p>Now that you understand binary patching:</p><ol><li><strong>Learn assembly</strong>: Read <a href=/blog/article_linux_syscalls_in_assembly/>Linux Syscalls in Assembly</a> to understand what you&rsquo;re modifying</li><li><strong>Master GDB</strong>: Use <a href=/blog/article_getting_start_with_gdb/>GDB</a> to inspect binaries and find patch locations</li><li><strong>Study ELF format</strong>: Learn about executable file structure to patch safely</li><li><strong>Practice with CTFs</strong>: Capture The Flag challenges often require binary patching skills</li></ol><div class="alert alert-success my-4" role=alert><div class="fw-bold mb-2">Advanced Tools</div><p>For more sophisticated binary modification:</p><ul><li><strong>radare2</strong> - Reverse engineering framework with patching capabilities</li><li><strong>Binary Ninja</strong> - Commercial binary analysis platform</li><li><strong>Ghidra</strong> - NSA&rsquo;s free reverse engineering tool</li><li><strong>objcopy</strong> - GNU tool for modifying object files</li></ul></div><h2 id=see-also>See Also</h2><ul><li><a href=/blog/article_getting_start_with_gdb/>Getting Started with GDB</a> - Debug and inspect binaries to find patch locations</li><li><a href=/blog/article_linux_syscalls_in_assembly/>Linux Syscalls in Assembly</a> - Understand low-level program execution</li><li><a href=/blog/cheatsheet_gcc_compiling/>GCC Compiling Cheat Sheet</a> - Learn about compilation and linking</li><li><a href=https://linux.die.net/man/1/xxd>xxd Manual</a> - Complete xxd documentation</li><li><a href=http://www.daemonology.net/bsdiff/>bsdiff Documentation</a> - Official bsdiff documentation</li></ul><div class=mt-4><script src=https://giscus.app/client.js data-repo=psylinux/psylinux.github.io data-repo-id=R_kgDORCdA4Q data-category=Comments data-category-id=DIC_kwDORCdA4c4C1fwh data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></article></main><div class=footer><div class="mb-4 d-flex flex-row justify-content-around"><div class=mr-4><i class="text-secondary bi bi-chevron-left" style=font-size:2em></i></div><div class=ms-4><a href=/howto/howto_install_pyenv/ data-toggle=tooltip data-placement=top title="HowTo :: Install PyEnv (Simple Python Version Management)"><i class="bi bi-chevron-right" style=font-size:2em></i></a></div></div><footer class="border-top border-light py-2 d-flex flex-row flex-wrap justify-content-between"><div class=copyright><small>psylinux</small></div><div><small>Copyrighted © Marcos Azevedo, 2025.</small></div></footer><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "b1b9cb012238436c9efbac840abc1907"}'></script></div></body></html>